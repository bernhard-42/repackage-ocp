diff --git a/cadquery/occ_impl/exporters/dxf.py b/cadquery/occ_impl/exporters/dxf.py
index 7a71173..296c442 100644
--- a/cadquery/occ_impl/exporters/dxf.py
+++ b/cadquery/occ_impl/exporters/dxf.py
@@ -343,8 +343,20 @@ class DxfDocument:
         spline.Transform(adaptor.Trsf())
 
         order = spline.Degree() + 1
-        knots = list(spline.KnotSequence())
-        poles = [(p.X(), p.Y(), p.Z()) for p in spline.Poles()]
+        
+        # knots = list(spline.KnotSequence())
+        knots = []
+        for i in range(1, spline.NbKnots() + 1):
+            knot = spline.Knot(i)
+            for j in range(spline.Multiplicity(i)):
+                knots.append(knot)
+
+        # poles = [(p.X(), p.Y(), p.Z()) for p in spline.Poles()]
+        poles = []
+        for i in range(1, spline.NbPoles() + 1):
+            p = spline.Pole(i)
+            poles.append((p.X(), p.Y(), p.Z()))
+
         weights = (
             [spline.Weight(i) for i in range(1, spline.NbPoles() + 1)]
             if spline.IsRational()
diff --git a/cadquery/occ_impl/shapes.py b/cadquery/occ_impl/shapes.py
index cedc480..dfa75bd 100644
--- a/cadquery/occ_impl/shapes.py
+++ b/cadquery/occ_impl/shapes.py
@@ -596,7 +596,7 @@ class Shape(object):
         Returns a hashed value denoting this shape. It is computed from the
         TShape and the Location. The Orientation is not used.
         """
-        return self.wrapped.HashCode(HASH_CODE_MAX)
+        return hash(self.wrapped)
 
     def isNull(self) -> bool:
         """
diff --git a/setup.py b/setup.py
index 9ad7b6b..16c700c 100644
--- a/setup.py
+++ b/setup.py
@@ -26,7 +26,7 @@ is_conda = "CONDA_PREFIX" in os.environ
 # Only include the installation dependencies if we are not running on RTD or AppVeyor or in a conda env
 if not is_rtd and not is_appveyor and not is_azure and not is_conda:
     reqs = [
-        "cadquery-ocp>=7.7.0,<7.8",
+        "cadquery-ocp>=7.8.0,<7.9",
         "ezdxf",
         "multimethod>=1.11,<2.0",
         "nlopt>=2.9.0,<3.0",
